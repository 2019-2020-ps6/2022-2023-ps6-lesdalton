FROM mcr.microsoft.com/playwright:v1.34.3-jammy

ARG ENVIRONMENT

USER pwuser

WORKDIR /app

COPY --chown=pwuser:pwuser package.json package-lock.json ./
RUN npm install --no-cache

COPY --chown=pwuser:pwuser . .

RUN npm run test:$ENVIRONMENT

COPY --chown=pwuser:pwuser ./test-results /app/test-results
